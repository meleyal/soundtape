((function(){"use strict";if(!this.require){var a={},b={},c={}.hasOwnProperty,d=function(a,b){var c=[],d,e;/^\.\.?(\/|$)/.test(b)?d=[a,b].join("/").split("/"):d=b.split("/");for(var f=0,g=d.length;f<g;f++)e=d[f],e==".."?c.pop():e!="."&&e!=""&&c.push(e);return c.join("/")},e=function(e,f){var g=f?b:a,h;if(c.call(g,e))return e;h=d(e,"./index");if(c.call(g,h))return h},f=function(a,c,d){var e={id:c,exports:{}};try{b[c]=e.exports,d(e.exports,function(a){return g(a,h(c))},e),b[c]=e.exports}catch(f){throw delete b[c],f}return b[c]},g=function(c,g){var h=d(g,c),i;if(i=e(h,!0))return b[i];if(i=e(h,!1))return f(c,i,a[i]);throw new Error("Cannot find module '"+c+"'")},h=function(a){return a.split("/").slice(0,-1).join("/")};this.require=function(a){return g(a,"")},this.require.brunch=!0,this.require.define=function(b){for(var d in b)c.call(b,d)&&(a[d]=b[d])}}})).call(this),this.require.define({application:function(a,b,c){((function(){var a,d,e,f,g,h,i,j,k,l,m;h=b("lib/router"),f=b("models/playlists"),j=b("models/sounds"),g=b("views/playlists_view"),e=b("views/playlist_new_view"),m=b("views/welcome_view"),d=b("views/banner_view"),l=b("views/tabs_view"),k=b("views/sounds_view"),i=b("views/sound_new_view"),c.exports=a=function(){function a(){var a=this;$(function(){return a.initialize(),Backbone.history.start({pushState:!0}),typeof console!="undefined"&&console!==null?console.log("Hire me :) http://meleyal.com"):void 0})}return a.prototype.apiKey="76fc7439611dfed3405d099962c576d7",a.prototype.initialize=function(){return SC.initialize({client_id:this.apiKey}),this.router=new h,this.playlists=new f,this.sounds=new j,this.welcomeView=new m,this.bannerView=new d,this.tabsView=new l,this.playlistsView=new g,this.playlistNewView=new e,this.soundsView=new k,this.soundNewView=new i},a}(),window.app=new a})).call(this)}}),this.require.define({"lib/router":function(a,b,c){((function(){var a,b=Object.prototype.hasOwnProperty,d=function(a,c){function e(){this.constructor=a}for(var d in c)b.call(c,d)&&(a[d]=c[d]);return e.prototype=c.prototype,a.prototype=new e,a.__super__=c.prototype,a};c.exports=a=function(a){function b(){b.__super__.constructor.apply(this,arguments)}return d(b,a),b.prototype.routes={"":"index","*all":"redirect"},b.prototype.index=function(){var a;return $("#content").append(app.bannerView.render().el),$("#content").append(app.tabsView.render().el),$("#content").append(app.soundsView.render().el),app.playlists.fetch(),app.playlists.length>0?(a=_.cookie("playlist"))?app.playlists.get(a).set({selected:!0}):app.playlists.first().set({selected:!0}):$("#content").append(app.welcomeView.render().el)},b.prototype.redirect=function(){return this.navigate("")},b}(Backbone.Router)})).call(this)}}),this.require.define({"models/playlist":function(a,b,c){((function(){var a,d,e=function(a,b){return function(){return a.apply(b,arguments)}},f=Object.prototype.hasOwnProperty,g=function(a,b){function d(){this.constructor=a}for(var c in b)f.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};d=b("../models/sounds"),c.exports=a=function(a){function b(){this.playNext=e(this.playNext,this),b.__super__.constructor.apply(this,arguments)}return g(b,a),b.prototype.defaults={title:"SoundTape",description:"",selected:!1},b.prototype.initialize=function(){var a;return app.sounds.fetch(),a=app.sounds.where({playlist_id:this.id}),this.sounds=new d(a),this.get("color")==null&&this.set("color",this.randomColor()),this.sounds.on("finished",this.playNext),b.__super__.initialize.apply(this,arguments)},b.prototype.randomColor=function(){return"#"+Math.floor(Math.random()*16777215).toString(16)},b.prototype.playNext=function(a){var b,c;b=this.sounds.indexOf(a),c=this.sounds.at(b-1);if(c)return c.set({play:!0})},b}(Backbone.Model)})).call(this)}}),this.require.define({"models/playlists":function(a,b,c){((function(){var a,d=function(a,b){return function(){return a.apply(b,arguments)}},e=Object.prototype.hasOwnProperty,f=function(a,b){function d(){this.constructor=a}for(var c in b)e.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};c.exports=a=function(a){function c(){this.setCookie=d(this.setCookie,this),c.__super__.constructor.apply(this,arguments)}return f(c,a),c.prototype.model=b("./playlist"),c.prototype.localStorage=new Backbone.LocalStorage("Playlists"),c.prototype.initialize=function(){return this.on("change:selected",this.deactivateOthers),this.on("change:selected",this.setCookie)},c.prototype.current=function(){return this.where({selected:!0})[0]},c.prototype.deactivateOthers=function(a){var b,c,d,e,f;c=this.filter(function(b){return b!==a}),f=[];for(d=0,e=c.length;d<e;d++)b=c[d],f.push(b.set({selected:!1},{silent:!0}));return f},c.prototype.setCookie=function(a){if(a.get("selected")!=null)return _.cookie("playlist",a.get("id"))},c}(Backbone.Collection)})).call(this)}}),this.require.define({"models/sound":function(a,b,c){((function(){var a,b=Object.prototype.hasOwnProperty,d=function(a,c){function e(){this.constructor=a}for(var d in c)b.call(c,d)&&(a[d]=c[d]);return e.prototype=c.prototype,a.prototype=new e,a.__super__=c.prototype,a};c.exports=a=function(a){function b(){b.__super__.constructor.apply(this,arguments)}return d(b,a),b.prototype.defaults={play:!1},b}(Backbone.Model)})).call(this)}}),this.require.define({"models/sounds":function(a,b,c){((function(){var a,d=function(a,b){return function(){return a.apply(b,arguments)}},e=Object.prototype.hasOwnProperty,f=function(a,b){function d(){this.constructor=a}for(var c in b)e.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};c.exports=a=function(a){function c(){this.pauseOthers=d(this.pauseOthers,this),c.__super__.constructor.apply(this,arguments)}return f(c,a),c.prototype.model=b("./sound"),c.prototype.localStorage=new Backbone.LocalStorage("Sounds"),c.prototype.initialize=function(){return this.on("change:play",this.pauseOthers)},c.prototype.pauseOthers=function(a){var b,c,d,e,f;if(a.get("play")){c=this.filter(function(b){return b!==a}),f=[];for(d=0,e=c.length;d<e;d++)b=c[d],f.push(b.set({play:!1}));return f}},c}(Backbone.Collection)})).call(this)}}),this.require.define({"views/banner_view":function(a,b,c){((function(){var a,d,e=function(a,b){return function(){return a.apply(b,arguments)}},f=Object.prototype.hasOwnProperty,g=function(a,b){function d(){this.constructor=a}for(var c in b)f.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};d=b("../models/playlist"),c.exports=a=function(a){function c(){this.deactivateTabs=e(this.deactivateTabs,this),this.activateTab=e(this.activateTab,this),this.render=e(this.render,this),c.__super__.constructor.apply(this,arguments)}return g(c,a),c.prototype.tagName="header",c.prototype.className="banner",c.prototype.template=b("./templates/banner"),c.prototype.events={"click nav a":"activateTab"},c.prototype.initialize=function(){return app.playlists.on("change:selected",this.render)},c.prototype.render=function(a){return a==null&&(a=new d({color:"#F60"})),this.$el.html(this.template({model:a})),this.$el.css({backgroundColor:a.get("color")}),this},c.prototype.activateTab=function(a){var b,c;a.preventDefault(),c=$(a.currentTarget),b=c.attr("data-action");if(c.is(".active"))return;return this.$("nav a").removeClass("active"),c.addClass("active"),app.tabsView.switchTo(b)},c.prototype.deactivateTabs=function(a){return this.$("nav a").removeClass("active")},c}(Backbone.View)})).call(this)}}),this.require.define({"views/playlist_new_view":function(a,b,c){((function(){var a,d=function(a,b){return function(){return a.apply(b,arguments)}},e=Object.prototype.hasOwnProperty,f=function(a,b){function d(){this.constructor=a}for(var c in b)e.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};c.exports=a=function(a){function c(){this.create=d(this.create,this),this.render=d(this.render,this),c.__super__.constructor.apply(this,arguments)}return f(c,a),c.prototype.className="playlist-new tab",c.prototype.template=b("./templates/playlist_new"),c.prototype.events={"submit form":"create"},c.prototype.render=function(){return this.$el.html(this.template),this},c.prototype.hide=function(){return this.$("form")[0].reset(),this.$el.hide()},c.prototype.create=function(a){var b,c;a.preventDefault(),b={title:this.$('input[name="title"]').val(),description:this.$('input[name="description"]').val()};if(b.title!=="")return c=app.playlists.create(b),c.set({selected:!0}),this.hide()},c}(Backbone.View)})).call(this)}}),this.require.define({"views/playlist_view":function(a,b,c){((function(){var a,d=function(a,b){return function(){return a.apply(b,arguments)}},e=Object.prototype.hasOwnProperty,f=function(a,b){function d(){this.constructor=a}for(var c in b)e.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};c.exports=a=function(a){function c(){this.select=d(this.select,this),c.__super__.constructor.apply(this,arguments)}return f(c,a),c.prototype.className="playlist",c.prototype.template=b("./templates/playlist"),c.prototype.events={click:"select"},c.prototype.render=function(a){return this.model=a,this.$el.html(this.template({model:a})),this.$el.css({backgroundColor:a.get("color")}),this},c.prototype.select=function(a){return a.preventDefault(),this.model.set({selected:!0})},c}(Backbone.View)})).call(this)}}),this.require.define({"views/playlists_view":function(a,b,c){((function(){var a,d,e=function(a,b){return function(){return a.apply(b,arguments)}},f=Object.prototype.hasOwnProperty,g=function(a,b){function d(){this.constructor=a}for(var c in b)f.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};a=b("./playlist_view"),c.exports=d=function(b){function c(){this.addAll=e(this.addAll,this),this.addOne=e(this.addOne,this),this.hide=e(this.hide,this),c.__super__.constructor.apply(this,arguments)}return g(c,b),c.prototype.className="playlists tab",c.prototype.initialize=function(){return app.playlists.on("reset",this.addAll),app.playlists.on("add",this.addOne),app.playlists.on("change:selected",this.hide)},c.prototype.render=function(){return this},c.prototype.hide=function(){return this.$el.hide()},c.prototype.addOne=function(b){var c;return c=new a,this.$el.append(c.render(b).el)},c.prototype.addAll=function(a){return a.each(this.addOne)},c}(Backbone.View)})).call(this)}}),this.require.define({"views/sound_new_view":function(a,b,c){((function(){var a,d=function(a,b){return function(){return a.apply(b,arguments)}},e=Object.prototype.hasOwnProperty,f=function(a,b){function d(){this.constructor=a}for(var c in b)e.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};c.exports=a=function(a){function c(){this.create=d(this.create,this),this["new"]=d(this["new"],this),this.render=d(this.render,this),c.__super__.constructor.apply(this,arguments)}return f(c,a),c.prototype.className="sound-new tab",c.prototype.template=b("./templates/sound_new"),c.prototype.apiUrls={resolve:"http://api.soundcloud.com/resolve.json",waveform:"http://waveformjs.org/w"},c.prototype.events={"submit form":"new"},c.prototype.render=function(){return this.$el.html(this.template),this},c.prototype.hide=function(){return this.$("form")[0].reset(),this.$el.hide()},c.prototype["new"]=function(a){var b,c;a.preventDefault(),c=this.$('input[name="url"]').val();if(c.match(/soundcloud.com/)!=null)return b=$.getJSON(""+this.apiUrls.resolve+"?url="+c+"&client_id="+app.apiKey),b.success(this.create)},c.prototype.create=function(a){var b,c=this;if(a.kind!=="track")return;return b=app.playlists.current(),$.when(this.getWaveformData(a.waveform_url)).then(function(d){var e,f;return e={track_id:a.id,playlist_id:b.id,waveform_data:d},f=b.sounds.create(_.extend(a,e)),app.soundsView.addOne(f),app.bannerView.deactivateTabs(),c.hide()})},c.prototype.getWaveformData=function(a){var b,c,d=this;return b=$.Deferred(),c=$.getJSON(""+this.apiUrls.waveform+"?url="+a+"&callback=?"),c.success(function(a){return b.resolve(a)}),b.promise()},c}(Backbone.View)})).call(this)}}),this.require.define({"views/sound_view":function(a,b,c){((function(){var a,b=function(a,b){return function(){return a.apply(b,arguments)}},d=Object.prototype.hasOwnProperty,e=function(a,b){function e(){this.constructor=a}for(var c in b)d.call(b,c)&&(a[c]=b[c]);return e.prototype=b.prototype,a.prototype=new e,a.__super__=b.prototype,a};c.exports=a=function(a){function c(){this.streamTrack=b(this.streamTrack,this),this.render=b(this.render,this),this.showOnSoundCloud=b(this.showOnSoundCloud,this),this.onChangePlaying=b(this.onChangePlaying,this),this.togglePlay=b(this.togglePlay,this),c.__super__.constructor.apply(this,arguments)}return e(c,a),c.prototype.className="sound",c.prototype.events={click:"togglePlay",dblclick:"showOnSoundCloud"},c.prototype.initialize=function(){return this.$el.attr("title","Click to play, double click to open on SoundCloud")},c.prototype.togglePlay=function(a){var b;return b=this.model.get("play"),this.model.set({play:!b})},c.prototype.onChangePlaying=function(a){return a.get("play")?this.stream.play():this.stream.pause()},c.prototype.showOnSoundCloud=function(a){return window.open(this.model.get("permalink_url"))},c.prototype.render=function(a){return this.model=a,a.on("change:play",this.onChangePlaying),a.on("finished",this.onFinished),this.renderTrack(a),this},c.prototype.renderTrack=function(a){var b=this;return SC.get("/tracks/"+a.get("track_id"),function(c){var d;return d=b.renderWaveform(a.get("waveform_data")),b.streamTrack(c,d)})},c.prototype.renderWaveform=function(a){var b;return b={container:this.$el[0],innerColor:"#999",data:a},new Waveform(b)},c.prototype.streamTrack=function(a,b){var c,d,e=this;return d=b.optionsForSyncedStream(),c={onfinish:function(){return e.model.trigger("finished",e.model)}},_.extend(d,c),SC.stream(a.uri,d,function(a){return e.stream=a})},c}(Backbone.View)})).call(this)}}),this.require.define({"views/sounds_view":function(a,b,c){((function(){var a,d,e=function(a,b){return function(){return a.apply(b,arguments)}},f=Object.prototype.hasOwnProperty,g=function(a,b){function d(){this.constructor=a}for(var c in b)f.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};a=b("./sound_view"),c.exports=d=function(b){function c(){this.addAll=e(this.addAll,this),this.addOne=e(this.addOne,this),this.renderSounds=e(this.renderSounds,this),c.__super__.constructor.apply(this,arguments)}return g(c,b),c.prototype.className="sounds",c.prototype.initialize=function(){return app.playlists.on("change:selected",this.renderSounds)},c.prototype.render=function(){return this},c.prototype.renderSounds=function(a){return this.$el.empty(),this.addAll(a.sounds)},c.prototype.addOne=function(b){var c;return c=new a,this.$el.prepend(c.render(b).el)},c.prototype.addAll=function(a){return a.each(this.addOne)},c}(Backbone.View)})).call(this)}}),this.require.define({"views/tabs_view":function(a,b,c){((function(){var a,b=Object.prototype.hasOwnProperty,d=function(a,c){function e(){this.constructor=a}for(var d in c)b.call(c,d)&&(a[d]=c[d]);return e.prototype=c.prototype,a.prototype=new e,a.__super__=c.prototype,a};c.exports=a=function(a){function b(){b.__super__.constructor.apply(this,arguments)}return d(b,a),b.prototype.className="tabs",b.prototype.render=function(){return this.$el.append(app.playlistsView.render().el),this.$el.append(app.soundNewView.render().el),this.$el.append(app.playlistNewView.render().el),this},b.prototype.switchTo=function(a){this.$(".tab").hide();switch(a){case"show-playlists":return this.$(".playlists").show();case"add-playlist":return this.$(".playlist-new").show().find("input").first().focus();case"add-sound":return this.$(".sound-new").show().find("input").focus()}},b}(Backbone.View)})).call(this)}}),this.require.define({"views/templates/banner":function(a,b,c){c.exports=function(a){a||(a={});var b=[],c=function(a){var c=b,d;return b=[],a.call(this),d=b.join(""),b=c,e(d)},d=function(a){return a&&a.ecoSafe?a:typeof a!="undefined"&&a!=null?g(a):""},e,f=a.safe,g=a.escape;return e=a.safe=function(a){if(a&&a.ecoSafe)return a;if(typeof a=="undefined"||a==null)a="";var b=new String(a);return b.ecoSafe=!0,b},g||(g=a.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){((function(){var a;b.push('<h1>\n  <a href="/" title="Home">\n    <img src="images/soundcloud.png" alt="SoundCloud" width="65" height="33">\n    '),b.push(d(this.model.get("title"))),b.push("\n  </a>\n</h1>\n\n<h2>\n  "),b.push(d(this.model.get("description"))),b.push("\n</h2>\n\n<nav>\n  "),((a=this.model.collection)!=null?a.length:void 0)>0&&(b.push('\n    <a href="#" data-action="add-playlist">Add Playlist +</a>\n    <a href="#" data-action="show-playlists">'),b.push(d(this.model.collection.length)),b.push(' playlists</a>\n    <a href="#" data-action="add-sound" class="divide">Add track to '),b.push(d(this.model.get("title"))),b.push(" +</a>\n  ")),b.push("\n</nav>\n")})).call(this)}.call(a),a.safe=f,a.escape=g,b.join("")}}}),this.require.define({"views/templates/playlist":function(a,b,c){c.exports=function(a){a||(a={});var b=[],c=function(a){var c=b,d;return b=[],a.call(this),d=b.join(""),b=c,e(d)},d=function(a){return a&&a.ecoSafe?a:typeof a!="undefined"&&a!=null?g(a):""},e,f=a.safe,g=a.escape;return e=a.safe=function(a){if(a&&a.ecoSafe)return a;if(typeof a=="undefined"||a==null)a="";var b=new String(a);return b.ecoSafe=!0,b},g||(g=a.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){((function(){b.push('<a href="#">\n  '),b.push(d(this.model.get("title"))),b.push("\n</a>\n")})).call(this)}.call(a),a.safe=f,a.escape=g,b.join("")}}}),this.require.define({"views/templates/playlist_new":function(a,b,c){c.exports=function(a){a||(a={});var b=[],c=function(a){var c=b,d;return b=[],a.call(this),d=b.join(""),b=c,e(d)},d=function(a){return a&&a.ecoSafe?a:typeof a!="undefined"&&a!=null?g(a):""},e,f=a.safe,g=a.escape;return e=a.safe=function(a){if(a&&a.ecoSafe)return a;if(typeof a=="undefined"||a==null)a="";var b=new String(a);return b.ecoSafe=!0,b},g||(g=a.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){((function(){b.push('<form>\n  <input name="title" type="text" placeholder="Title">\n  <input name="description" type="text" placeholder="Description (optional)">\n  <button type="submit">Add</button>\n</form>\n')})).call(this)}.call(a),a.safe=f,a.escape=g,b.join("")}}}),this.require.define({"views/templates/sound_new":function(a,b,c){c.exports=function(a){a||(a={});var b=[],c=function(a){var c=b,d;return b=[],a.call(this),d=b.join(""),b=c,e(d)},d=function(a){return a&&a.ecoSafe?a:typeof a!="undefined"&&a!=null?g(a):""},e,f=a.safe,g=a.escape;return e=a.safe=function(a){if(a&&a.ecoSafe)return a;if(typeof a=="undefined"||a==null)a="";var b=new String(a);return b.ecoSafe=!0,b},g||(g=a.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){((function(){b.push('<form novalidate>\n  <input name="url" type="url" placeholder="SoundCloud track URL">\n  <button type="submit">Add</button>\n</form>\n')})).call(this)}.call(a),a.safe=f,a.escape=g,b.join("")}}}),this.require.define({"views/templates/welcome":function(a,b,c){c.exports=function(a){a||(a={});var b=[],c=function(a){var c=b,d;return b=[],a.call(this),d=b.join(""),b=c,e(d)},d=function(a){return a&&a.ecoSafe?a:typeof a!="undefined"&&a!=null?g(a):""},e,f=a.safe,g=a.escape;return e=a.safe=function(a){if(a&&a.ecoSafe)return a;if(typeof a=="undefined"||a==null)a="";var b=new String(a);return b.ecoSafe=!0,b},g||(g=a.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){((function(){b.push('<h2>Create playlists of your favorite tracks on SoundCloud.</h2>\n\n<form>\n  <input name="title" type="text" placeholder="Playlist name" autofocus><br>\n  <input name="description" type="text" placeholder="Playlist description (optional)">\n  <button type="submit">Create your first playlist</button>\n</form>\n')})).call(this)}.call(a),a.safe=f,a.escape=g,b.join("")}}}),this.require.define({"views/welcome_view":function(a,b,c){((function(){var a,d=function(a,b){return function(){return a.apply(b,arguments)}},e=Object.prototype.hasOwnProperty,f=function(a,b){function d(){this.constructor=a}for(var c in b)e.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};c.exports=a=function(a){function c(){this.create=d(this.create,this),c.__super__.constructor.apply(this,arguments)}return f(c,a),c.prototype.className="welcome",c.prototype.template=b("./templates/welcome"),c.prototype.events={"submit form":"create"},c.prototype.render=function(){return this.$el.html(this.template),this},c.prototype.create=function(a){var b,c;a.preventDefault(),b={title:this.$('input[name="title"]').val(),description:this.$('input[name="description"]').val()};if(b.title!=="")return c=app.playlists.create(b),c.set({selected:!0}),this.remove()},c}(Backbone.View)})).call(this)}})